from bs4 import BeautifulSoup
import requests
import pandas as pd

# Create an empty DataFrame with columns
data = {
    'Description': [],
    'Seniority Level': [],
    'Employment Type': [],
    'Job Function': [],
    'Industries': []
}

url = "https://www.linkedin.com/jobs/data-scientist-jobs?position=1&pageNum=0"

response = requests.get(url)
soup = BeautifulSoup(response.text, 'html.parser')
ul = soup.find('ul', class_ = 'jobs-search__results-list')
for li in ul.find_all('li'):
    link = li.find('div').find('a').get('href')
    print(link)
    soup2 = BeautifulSoup(requests.get(link).text, 'html.parser')

    crits = [li.find('span').text.strip() for li in soup2.find('ul', class_='description__job-criteria-list').find_all('li')]
    

    data['Description'].append(soup2.find('div', class_='show-more-less-html__markup').text.strip())
    data['Seniority Level'].append(crits[0])
    data['Employment Type'].append(crits[1])
    data['Job Function'].append(crits[2])
    data['Industries'].append(crits[3])


df = pd.DataFrame(data)
df.to_csv('data.csv', index=False)